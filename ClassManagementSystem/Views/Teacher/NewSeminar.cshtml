
@{
    Layout = null;
}


<!--删除讨论课，add按钮，修改讨论课的跳转还没有写-->

<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>新讨论课</title>
    <link href="../../css/Teacher/content.css" rel="stylesheet" type="text/css" />
   
</head>
<body>
    <div class="top">
        <div class="font">
            课堂管理系统
        </div>
        <div class="icon">
            <img src=".\home.png">首页
            <img src=".\help.png">帮助
            <img src=".\exit.png">退出
        </div>
        <div class="clear"></div>
    </div>
    <div class="body">
        
        <div class="navigation">
            <div class="courseName">OOAD</div>
            <div class="line"></div>
            <div class="courseIntroduction"></div>
        </div>
        <div class="content">
            <div class="classInfo">
                <div class="title">讨论课1</div>
                <div class="returnButton">返回上一页</div>
                <div class="line"></div>
                <div class="itemBody">
                    <div class="item">
                        <label class="itemName">讨论课名称:</label>
                        <label class="itemName" id="seName"></label>
                        <input type="text" id="inputName" style="display:none" />
                    </div>
                    <div class="item">
                        <label class="itemName">讨论课说明:</label>
                        <label class="itemName" id="seDescription"></label>
                        <input type="text" id="inputDescription" style="display:none" />
                    </div>
                    <div class="item">
                        <label class="itemName">分 组 方 式:</label>
                        <label class="itemName" id="seGroupingMethod"></label>
                        <input type="text" id="inputGroupingMethod" style="display:none" />
                    </div>
                    <div class="item">
                        <label class="itemName">开 始 时 间:</label>
                        <label class="itemName" id="seStartTime"></label>
                        <input type="text" id="inputStartTime" style="display:none" />
                    </div>
                    <div class="item">
                        <label class="itemName">结 束 时 间:</label>
                        <label class="itemName" id="seEndTime"></label>
                        <input type="text" id="inputEndTime" style="display:none" />
                    </div>

                    <div class="item">
                        <button class="leftButton" id="score">评分</button>
                        <button class="middleButton" id="up_sub" onclick="update_submit()">修改</button>
                        <button class="rightButton" id="delete">删除讨论课 </button>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <div class="seminarInfo">
                <div class="title">Topic</div>
                <div class="line"></div>
                <br><br />
                <div class="topicBlockBody" style="margin-left: 5%">
                    <div class="topicBlock"><div class="topicBlockFont">Topic A</div></div>
                    <div class="topicBlock"><div class="topicBlockFont">Topic B</div></div>
                    <div class="topicBlock" id="add"> <img src="../../Img/add.png" width="110" height="110"></div>
                </div>
            </div>

        </div>

        <div class="clear"></div>
    </div>

    <script src="//code.jquery.com/jquery-1.10.2.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            var seminarId = window.location.href.split("=")[1];//获得当前seminarId
            $.ajax({
                type: 'GET',
                url: '/seminar/' + seminarId,
                contentType: "application/json;charset=utf-8",
                success: function (data, status) {
                    $('#seName').text(data.name);
                    $('#seDescription').text(data.description);
                    $('#seGroupingMethod').text(data.groupingMethod);
                    $('#seStartTime').text(data.startTime);
                    $('#seEndTime').text(data.endTime);
                }
            });
        })
    </script>
    <script type="text/javascript">
            $("#delete").click(function () {
                var seminarId = window.location.href.split("=")[1];
                $ajax({
                    type: "DELETE",
                    url: "/seminar/" + seminarId,
                    contentType: "application/json;charset=utf-8",
                    success: function (data,status) {
                        alert("delete success！" + data);
                    },
                    error: function (err) {
                        alert(err);
                    }
                })
            });
            $("#score").click(function () {
                var index = "1";
                var url = "/Teacher/TeacherScoreReport?index=" + index;//这个页面还没写
                window.location.href = url;
            });
            $("#add").click(function () {//跳转到创建讨论课的地方
                var index = "1";
                var url = "/Teacher/CreateTopic?index=" + index;
                window.location.href = url;
            });

    </script>
    <script type="text/javascript">
            function update_submit() {
                var seminarId = window.location.href.split("=")[1];//当前讨论课号
                if ($("#up_sub").text() == "修改") {
                    var seminarInfo = {
                        Name: $("#seName").text(),
                        Description: $("#seDescription").text(),  
                        GroupingMethod: $("#seGroupingMethod").text(),
                        StartTime: $("#seStartTime").text(),
                        EndTime: $("#seEndTime").text()
                    };
                    $("[id^='se']").hide();
                    $("[id^='input']").show();
                    $("#up_sub").text("提交");

                    $("#inputName").val(seminarInfo.Name);
                    $("#inputDescription").val(seminarInfo.Description);
                    $("#inputGroupingMethod").val(seminarInfo.GroupingMethod);
                    $("#inputStartTime").val(seminarInfo.StartTime);
                    $("#inputEndTime").val(seminarInfo.EndTime);

                }
                else {
                    var seminarInfo = {
                        Name: $("#inputName").val(),
                        Description: $("#inputDescription").val(),
                        GroupingMethod: $("#inputGroupingMethod").val(),
                        StartTime: $("#inputStartTime").val(),
                        EndTime: $("#inputEndTime").val()
                     
                    };

                    $.ajax({

                        url: "/seminar/" + seminarId,
                        type: "PUT",
                        contentType: "application/json;charset=utf-8",
                        dataType: "json",
                        data: JSON.stringify(seminarInfo),
                        success: function (data, status) {//如果controller写了topic put方法则可以交换这里上下的注释部分---------------
                            $("[id^='input']").hide();
                            $("[id^='se']").show();
                            $("#up_sub").text("修改");

                            $("#seName").text(seminarInfo.Name);
                            $("#seDescription").text(seminarInfo.Description);
                            $("#seGroupingMethod").text(seminarInfo.GroupingMethod);
                            $("#seStartTime").text(seminarInfo.StartTime);
                            $("#seEndTime").text(seminarInfo.EndTime);
                        }
                        //error:
                    });
                    $("[id^='input']").hide();
                    $("[id^='se']").show();
                    $("#up_sub").text("修改");

                    $("#seName").text(seminarInfo.Name);
                    $("#seDescription").text(seminarInfo.Description);
                    $("#seGroupingMethod").text(seminarInfo.GroupingMethod);
                    $("#seStartTime").text(seminarInfo.StartTime);
                    $("#seEndTime").text(seminarInfo.EndTime);
                }//else end
                //document.write("update");//--------------
            }//修改/确认点击结束
    </script>
</body>
</html>

